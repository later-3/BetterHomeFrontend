# 产品需求文档（PRD）
## 社区财务透明化系统

---

## 📋 文档信息

| 项目 | 内容 |
|------|------|
| **文档版本** | v2.3 |
| **创建日期** | 2025-10-13 |
| **最后更新** | 2025-10-13 |
| **产品负责人** | 待定 |
| **项目状态** | 需求确认中 |
| **优先级** | P0（高优先级） |

---

## 1. 项目概述

### 1.1 项目背景

BetterHome 是一个面向业主的社区管理小程序，当前已实现工单管理功能（业主可向物业提交工单、查看工单状态）。为了提升业主对物业服务的信任度，增强社区管理透明度，现需要增加**财务透明化功能**。

**系统架构**：
- **业主端（小程序）**：业主通过微信小程序查看财务信息、账单、缴费记录等（**仅查看，不支持线上缴费**）
- **物业端（后台管理系统）**：物业管理员通过 Web 后台录入账单、收支、管理员工等（MVP 阶段使用 Directus 管理后台或简单网页实现）

> **注**：
> - MVP 阶段重点是业主端小程序开发，物业端功能通过现有工具快速实现，不需要开发专门的小程序界面
> - **MVP 阶段业主只能查看财务信息，不支持线上支付功能**（线上支付计划在 v2.0+ 版本实现）
> - 业主缴费需线下完成（银行转账、现金等），物业管理员在后台录入缴费记录

### 1.2 核心问题

**业主痛点**：
- 每月缴纳物业费，但不清楚钱的具体去向
- 公共收益（广告费、停车费、场地租赁等）不透明
- 对物业人员配置和工资支出缺乏了解
- 缺乏透明的财务查询渠道

**物业痛点**：
- 财务记录分散，缺乏统一管理平台
- 业主频繁询问财务问题，沟通成本高
- 缺少可信的财务公示渠道

> **注**：维修基金管理、业委会监督功能将在 v2.0 版本中实现，MVP 阶段聚焦于基础财务透明功能。

### 1.3 项目目标

**业务目标（MVP）**：
1. 提升业主满意度，增强对物业的信任
2. 降低物业与业主之间的沟通成本
3. 规范社区财务管理流程

**产品目标（MVP）**：
1. 为业主提供清晰、可查询的财务信息
2. 为物业提供便捷的财务数据录入和管理工具
3. 确保数据安全和隐私保护

> **v2.0+ 扩展目标**：为业委会提供审批和监督功能、维修基金管理

**可量化指标**：
- 业主对财务透明度满意度提升至 ≥85%
- 物业财务咨询工单减少 ≥60%
- 财务数据录入效率提升 ≥40%
- 系统上线后 3 个月内覆盖 ≥80% 的活跃业主

---

## 2. 用户分析

### 2.1 目标用户

#### 👤 业主（Resident）
- **数量占比**：最多（一个小区几百到几千户）
- **技术水平**：普通用户，需要简单易用的界面
- **核心需求**：查看自己的账单和缴费记录、了解小区财务概况
- **使用场景**：缴费前查看账单、缴费后查看记录、每月查看财务公示

#### 👔 物业管理员（Property Manager）
- **数量占比**：少（每个小区 2-5 人）
- **技术水平**：熟悉操作，需要高效的数据录入工具
- **核心需求**：录入账单、记录收支、管理员工信息、生成报表
- **使用场景**：日常收支录入、月底财务结算、数据核对
- **使用设备**：电脑端 Web 后台（MVP 阶段使用 Directus 管理后台或简单网页）

> **注**：MVP 阶段物业管理员不使用小程序，而是通过 Directus 管理后台或单独的简单网页进行数据录入和管理。

#### 🏛️ 业委会成员（Committee Member）**【v2.0+ 规划】**
- **数量占比**：少（每个小区 5-9 人）
- **技术水平**：中等，关注数据准确性
- **核心需求**：审批维修基金使用、监督财务状况、查看详细报表
- **使用场景**：定期审查财务、审批大额支出、年度财务总结

> **注**：业委会相关功能在 MVP 阶段不涉及，将在后续版本中实现。

### 2.2 用户权限矩阵（MVP 阶段）

| 功能模块 | 业主<br/>（小程序） | 物业管理员<br/>（后台系统） | 业委会成员<br/>(v2.0+) |
|----------|------|-----------|-----------|
| **查看自己的账单** | ✅ 小程序 | 🔧 后台 | ✅ |
| **查看自己的缴费记录** | ✅ 小程序 | 🔧 后台 | ✅ |
| **查看小区财务概况** | ✅ 小程序（汇总） | 🔧 后台（详细） | ✅（详细） |
| **查看公共收入** | ✅ 小程序（汇总） | 🔧 后台（详细） | ✅（详细） |
| **查看支出明细** | ✅ 小程序（部分） | 🔧 后台（全部） | ✅（全部） |
| **查看维修基金** (v2.0+) | 🔮（自己的） | 🔮（所有） | 🔮（所有） |
| **创建/编辑账单** | ❌ | 🔧 后台 | ❌ |
| **录入缴费记录** | ❌ | 🔧 后台 | ❌ |
| **录入收入/支出** | ❌ | 🔧 后台 | ❌ |
| **管理员工信息** | ❌ | 🔧 后台 | 🔮（只读） |
| **审批维修基金使用** (v2.0+) | ❌ | ❌ | 🔮 |

**图例**：
- ✅ MVP阶段 - 小程序实现
- 🔧 MVP阶段 - 后台系统实现（Directus 或简单网页）
- 🔮 v2.0+规划
- ❌ 无权限

---

## 3. 功能需求

### 3.1 业主端功能（Resident Features）

#### 📊 F1. 财务概览
**优先级**：P0（MVP 核心功能）
**描述**：业主可以查看小区整体财务状况的汇总视图

**功能点（MVP）**：
- 显示本月收入、支出、结余
- 显示本人欠费金额（如有）
- 显示最近收支趋势图（近 6 个月）
- 快速入口：我的账单、月度账目

**功能点（v2.0+）**：
- 显示维修基金余额（本人的）
- 快速入口：维修基金

**验收标准**：
- [ ] 数据实时更新（刷新后立即展示最新数据）
- [ ] 金额显示精确到分（两位小数）
- [ ] 支持下拉刷新
- [ ] 首次加载时间 < 2 秒

#### 💰 F2. 我的账单
**优先级**：P0（MVP 核心功能）
**描述**：业主查看自己的物业费账单列表

**功能点（MVP）**：
- 按月份倒序展示账单列表
- 每条账单显示：账期、应缴金额、实缴金额、状态（已缴/部分已缴/未缴/逾期）
- 支持筛选：全部/未缴/已缴/逾期
- 点击账单查看详情（账单详情页）
- 支持分页加载（每页 20 条）

**功能点（v2.0+）**：
- 支持线上缴费（跳转到支付页面）
- 支持微信支付、支付宝等在线支付方式

**账单状态定义**：
- `未缴`：未支付任何金额
- `部分已缴`：已支付金额 < 应缴金额
- `已缴`：已支付金额 >= 应缴金额
- `逾期`：超过到期日期且未缴清

**验收标准（MVP）**：
- [ ] 列表支持下拉刷新和上拉加载更多
- [ ] 逾期账单标红显示
- [ ] 状态标签颜色区分明显
- [ ] **MVP 不包含"缴费"按钮或跳转功能**

**验收标准（v2.0+）**：
- [ ] 点击"立即缴费"按钮跳转到支付页面
- [ ] 支持选择支付方式（微信支付/支付宝）
- [ ] 支付成功后账单状态自动更新

#### 📄 F3. 账单详情
**优先级**：P0（MVP 核心功能）
**描述**：查看单条账单的详细信息和缴费记录

**功能点（MVP）**：
- 显示账单基本信息：账期、房号、面积、单价、应缴金额、到期日期
- 显示缴费记录列表：缴费日期、缴费金额、支付方式、交易单号
- 显示缴费凭证（如有图片/文件）
- 支持查看大图（点击凭证图片）
- 显示逾期费用（如有）

**功能点（v2.0+）**：
- 提供"立即缴费"按钮（跳转到支付页面）
- 支持查看支付进度和支付结果

**验收标准（MVP）**：
- [ ] 数据完整显示，无遗漏
- [ ] 凭证图片支持预览和缩放
- [ ] 支持复制交易单号
- [ ] 多次缴费记录按时间倒序排列
- [ ] **MVP 不包含"立即缴费"按钮**

**验收标准（v2.0+）**：
- [ ] 未缴清账单显示"立即缴费"按钮
- [ ] 点击按钮跳转到支付页面，金额自动填充
- [ ] 支付成功后页面自动刷新显示最新状态

#### 📅 F4. 月度账目
**优先级**：P1（MVP 增强功能）
**描述**：查看小区每月的收入和支出汇总

**功能点**：
- 按月份选择查看（默认当月）
- 显示收入构成：物业费收入、公共收入
- 显示支出构成：人员工资、日常维护、水电费、材料采购、活动经费等
- 显示本月结余
- 支持查看具体项目明细（点击跳转到详情列表）

**验收标准**：
- [ ] 数据分类清晰，易于理解
- [ ] 支持月份快速切换（左右滑动或下拉选择）
- [ ] 金额计算准确无误
- [ ] 支持分享月度账目截图

#### 🏗️ F5. 维修基金账户 **【v2.0+ 规划】**
**优先级**：P2（v2.0+ 版本实现）
**描述**：查看业主自己的维修基金账户信息

> **注**：维修基金功能在 MVP 阶段不涉及，将在后续版本中实现。但在架构设计上已考虑扩展性。

**功能点（v2.0+）**：
- 显示账户余额：累计缴存、累计使用、当前余额
- 显示缴存记录：缴存日期、缴存金额、缴存方式
- 显示使用记录：使用日期、用途、金额、审批状态
- 说明维修基金的用途和管理规定

**验收标准（v2.0+）**：
- [ ] 余额计算准确（累计缴存 - 累计使用 = 当前余额）
- [ ] 记录按时间倒序排列
- [ ] 使用记录显示审批状态（待审批/已批准/已拒绝）
- [ ] 提供维修基金使用规则说明链接

#### 💸 F6. 公共收入明细
**优先级**：P1（MVP 增强功能）
**描述**：查看小区公共收入的详细记录

**功能点**：
- 按收入类型筛选：广告收入、停车费、场地租赁、自动售货机、快递柜、废品回收、其他
- 每条记录显示：日期、收入类型、项目名称、金额、相关信息
- 支持查看收入凭证（如合同、收据等）
- 显示每月公共收入汇总

**验收标准**：
- [ ] 支持多条件筛选（时间范围 + 收入类型）
- [ ] 凭证图片/文件可下载查看
- [ ] 列表支持分页加载
- [ ] 显示每条记录的录入人（物业管理员）

---

### 3.2 物业管理员功能（Property Manager Features）**【后台管理系统】**

> **重要说明**：物业管理员功能在 MVP 阶段**不在小程序中实现**，而是通过以下方式之一实现：
> 1. **Directus 管理后台**：直接使用 Directus 的 Admin Panel 进行数据录入和管理（推荐用于 MVP 快速验证）
> 2. **简单网页系统**：开发简单的 Web 管理界面，供物业人员使用
>
> 以下功能需求用于指导后台系统的数据结构和业务逻辑设计，但 UI 实现不在小程序开发范围内。

#### 📝 F7. 账单管理 **【后台系统】**
**优先级**：P0（MVP 核心功能）
**实现方式**：Directus 后台 或 简单网页
**描述**：物业管理员创建、编辑、查询物业费账单

**功能点**：
- **批量生成账单**：选择账期、自动生成所有业主的账单（基于房屋面积和单价）
- **单个创建账单**：手动为某户创建账单
- **编辑账单**：修改账单金额、到期日期、备注
- **查询账单**：按房号、业主姓名、账期、状态查询
- **导出账单**：导出 Excel 格式的账单列表

**验收标准**：
- [ ] 批量生成账单时支持预览
- [ ] 编辑后保留操作日志（谁在什么时间修改了什么）
- [ ] 查询结果准确，响应时间 < 1 秒
- [ ] 导出的 Excel 格式规范，包含所有必要字段

#### 💳 F8. 缴费录入 **【后台系统】**
**优先级**：P0（MVP 核心功能）
**实现方式**：Directus 后台 或 简单网页
**描述**：物业管理员录入业主的缴费记录

**功能点**：
- 搜索并选择账单（按房号或业主姓名）
- 填写缴费信息：缴费金额、缴费日期、支付方式（微信/支付宝/银行转账/现金/其他）
- 填写缴费人信息：姓名、联系电话
- 上传缴费凭证（支持多张图片或文件）
- 自动计算剩余欠款

**验收标准**：
- [ ] 缴费金额不能超过欠款金额（可配置是否允许多缴）
- [ ] 支持部分缴费（记录多次缴费直到缴清）
- [ ] 凭证上传支持拍照或从相册选择
- [ ] 提交后立即更新账单状态

#### 📈 F9. 收入录入 **【后台系统】**
**优先级**：P0（MVP 核心功能）
**实现方式**：Directus 后台 或 简单网页
**描述**：物业管理员录入公共收入

**功能点**：
- 选择收入类型：广告收入、停车费、场地租赁、自动售货机、快递柜、废品回收、其他
- 填写收入信息：项目名称、金额、收入日期、账期（YYYY-MM）
- 填写相关信息（JSON）：合同编号、租户名称等
- 填写支付方式和交易单号
- 上传收入凭证（合同、收据等）

**验收标准**：
- [ ] 必填字段校验：收入类型、金额、收入日期
- [ ] 金额必须为正数
- [ ] 日期不能超过当前日期
- [ ] 凭证上传必选（至少一张）

#### 📉 F10. 支出录入 **【后台系统】**
**优先级**：P0（MVP 核心功能）
**实现方式**：Directus 后台 或 简单网页
**描述**：物业管理员录入支出记录

**功能点（MVP）**：
- 选择支出类型：人员工资、日常维护、水电费、材料采购、活动经费、其他
- 填写支出信息：项目名称、金额、支付日期、账期
- 填写支付方式和交易单号
- 上传支出凭证（发票、收据等）

**功能点（v2.0+）**：
- 支出类型扩展：业委会经费、维修基金支出
- 大额支出（>5000元）标记为待审批，需业委会审批

**验收标准（MVP）**：
- [ ] 支出类型选择与实际业务匹配
- [ ] 凭证必须上传

**验收标准（v2.0+）**：
- [ ] 维修基金支出需要关联维修基金使用记录
- [ ] 大额支出在业委会审批前状态为"待审批"

#### 👥 F11. 员工管理 **【后台系统】**
**优先级**：P0（MVP 核心功能）
**实现方式**：Directus 后台 或 简单网页
**描述**：物业管理员管理小区员工信息

**功能点**：
- 新增员工：录入姓名、联系电话、身份证后4位、岗位类型、职位名称、基础工资、入职日期
- 编辑员工：修改员工信息（离职员工不可编辑基本信息，只能修改离职日期）
- 设置员工状态：在职/离职/请假/停职
- 查询员工：按姓名、岗位类型、状态查询
- 查看员工工资记录

**岗位类型**：
- 保安、保洁、管理人员、电工、水暖工、绿化工、临时工、其他

**隐私保护**：
- 身份证号只存储后4位
- 员工工资对普通业主不可见（只显示总工资支出）

**验收标准**：
- [ ] 员工信息完整性校验
- [ ] 离职员工不可删除，只能标记离职
- [ ] 同一小区员工姓名+联系电话不能重复
- [ ] 工资记录与员工信息关联正确

#### 💼 F12. 工资录入 **【后台系统】**
**优先级**：P0（MVP 核心功能）
**实现方式**：Directus 后台 或 简单网页
**描述**：物业管理员录入员工工资

**功能点**：
- 选择账期（YYYY-MM）
- 选择员工（支持批量选择）
- 填写工资明细：基础工资、奖金、补贴、扣款、社保、公积金、实发金额
- 选择发放日期和支付方式
- 自动关联到支出记录（支出类型=人员工资）

**验收标准**：
- [ ] 实发金额 = 基础工资 + 奖金 + 补贴 - 扣款 - 社保 - 公积金
- [ ] 同一员工同一账期不能重复录入工资
- [ ] 工资录入后自动创建对应的支出记录
- [ ] 支持批量导入工资（Excel）

#### 🔍 F13. 逾期账单查询 **【后台系统】**
**优先级**：P1（MVP 增强功能）
**实现方式**：Directus 后台 或 简单网页
**描述**：物业管理员查询和催缴逾期账单

**功能点**：
- 显示所有逾期账单列表
- 按逾期时长排序（逾期最久的在前）
- 显示逾期天数和逾期费用
- 支持筛选：按楼栋、按逾期时长
- 支持批量发送催缴通知（短信/小程序消息）
- 支持导出逾期账单列表

**验收标准**：
- [ ] 逾期天数计算准确（当前日期 - 到期日期）
- [ ] 逾期费用按规则自动计算（可配置）
- [ ] 催缴通知可触达业主
- [ ] 导出列表包含业主联系方式

---

### 3.3 业委会成员功能（Committee Member Features）**【v2.0+ 规划】**

> **注**：业委会相关功能在 MVP 阶段不涉及，将在后续版本中实现。以下功能已在架构设计中考虑扩展性。

#### 🔐 F14. 维修基金审批 **【v2.0+ 规划】**
**优先级**：P2（v2.0+ 版本实现）
**描述**：业委会成员审批维修基金的使用申请

**功能点（v2.0+）**：
- 查看待审批的维修基金使用申请列表
- 查看申请详情：用途、金额、申请人、申请日期、相关凭证
- 审批操作：批准/拒绝，填写审批意见
- 查看历史审批记录
- 审批后通知申请人（物业管理员）

**验收标准（v2.0+）**：
- [ ] 审批记录包含审批人、审批时间、审批意见
- [ ] 审批通过后，维修基金才能实际扣减
- [ ] 审批拒绝后，申请状态变更为"已拒绝"
- [ ] 支持多人会签（可配置）

#### 📊 F15. 业委会财务总览 **【v2.0+ 规划】**
**优先级**：P2（v2.0+ 版本实现）
**描述**：业委会成员查看小区财务的详细报表

**功能点（v2.0+）**：
- 查看年度财务汇总：总收入、总支出、结余
- 查看月度财务对比（折线图）
- 查看支出构成（饼图/柱状图）
- 查看收入构成（饼图/柱状图）
- 查看维修基金总体情况：总缴存、总使用、总余额
- 下载财务报表（PDF/Excel）

**验收标准（v2.0+）**：
- [ ] 数据可视化清晰易懂
- [ ] 支持按年份/季度/月份切换
- [ ] 报表包含详细的数据明细
- [ ] 下载的报表可直接用于公示或审计

---

## 4. 非功能需求

### 4.1 性能要求
- **页面加载**：首屏加载时间 < 2 秒（4G 网络）
- **列表滚动**：分页加载，每页 20 条，滚动流畅无卡顿
- **图片加载**：凭证图片懒加载，使用缩略图优化
- **并发支持**：支持 500+ 业主同时在线查看

### 4.2 安全要求
- **数据隔离**：业主只能查看自己的账单和缴费记录
- **权限控制**：基于角色的访问控制（RBAC），严格区分三种角色权限
- **隐私保护**：
  - 员工身份证号只保存后 4 位
  - 员工工资对业主不可见（只显示总额）
  - 业主个人信息不互相可见
- **数据审计**：记录所有数据的创建、修改、删除操作日志
- **文件安全**：上传的凭证文件需要鉴权才能访问

### 4.3 可用性要求
- **兼容性**：支持微信小程序（iOS/Android）
- **适配**：支持不同屏幕尺寸（iPhone SE 到 iPad）
- **易用性**：
  - 关键操作不超过 3 步
  - 表单填写提供智能提示和默认值
  - 错误提示清晰，告知用户如何修复
- **无障碍**：字体大小可调，颜色对比符合规范

### 4.4 可维护性要求
- **代码规范**：遵循 TypeScript + Vue3 代码规范
- **模块化**：功能模块解耦，便于扩展
- **文档完善**：API 文档、组件文档齐全
- **错误监控**：集成错误日志上报

### 4.5 数据要求
- **数据备份**：每日自动备份数据库
- **数据准确性**：金额计算精确到分（两位小数）
- **数据完整性**：关键数据（账单、缴费、收支）不可删除，只能标记为作废
- **数据一致性**：账单的"已缴金额"必须等于所有缴费记录的金额之和

---

## 5. 验收标准

### 5.1 功能验收

#### 业主端 - 小程序（MVP - 必须全部通过）
- [ ] 能正常查看财务概览，数据准确
- [ ] 能查看自己的账单列表，状态正确
- [ ] 能查看账单详情和缴费记录
- [ ] 能查看月度账目，分类清晰
- [ ] 能查看公共收入明细

#### 物业管理员端 - 后台系统（MVP - 必须全部通过）
> 通过 Directus 后台或简单网页实现
- [ ] 能创建和编辑账单（通过 Directus Collections）
- [ ] 能录入缴费记录，账单状态自动更新（通过 Directus 或网页表单）
- [ ] 能录入公共收入（通过 Directus Collections）
- [ ] 能录入支出（通过 Directus Collections）
- [ ] 能管理员工信息（通过 Directus Collections）
- [ ] 能录入员工工资（通过 Directus Collections）
- [ ] 能查询逾期账单（通过 Directus Filters）

#### 业委会端（v2.0+ 规划）
- [ ] 能审批维修基金使用申请
- [ ] 能查看财务总览和报表

#### 维修基金功能（v2.0+ 规划）
- [ ] 业主能查看自己的维修基金账户
- [ ] 物业能录入维修基金缴存记录
- [ ] 物业能申请维修基金使用
- [ ] 业委会能审批维修基金使用

### 5.2 性能验收
- [ ] 首屏加载时间 < 2 秒（80% 的请求）
- [ ] 列表分页加载正常，无重复数据
- [ ] 图片加载不阻塞页面渲染

### 5.3 安全验收
- [ ] 业主无法查看其他业主的数据
- [ ] 普通业主无法查看员工工资明细
- [ ] 所有敏感操作有日志记录

**v2.0+ 安全验收**：
- [ ] 物业管理员无法审批维修基金
- [ ] 业委会成员只能审批维修基金，不能直接录入财务数据

### 5.4 兼容性验收
- [ ] 在微信开发者工具中运行正常
- [ ] 在 iOS 真机测试正常
- [ ] 在 Android 真机测试正常
- [ ] 在不同屏幕尺寸下显示正常

---

## 6. 约束与依赖

### 6.1 技术约束

**业主端（小程序）**：
- **前端框架**：uniapp + Vue3 + TypeScript + Pinia
- **UI 框架**：uview-plus
- **部署平台**：微信小程序

**物业端（后台管理）**：
- **MVP 方案 1**：直接使用 Directus Admin Panel（零开发）
- **MVP 方案 2**：简单 HTML + JavaScript 网页（低代码）
- **后端系统**：Directus（已有系统）

> **注**：MVP 阶段优先采用 Directus Admin Panel，无需额外开发物业端界面。

### 6.2 数据依赖
- 依赖 Directus 中已有的用户数据（业主、物业管理员、业委会成员）
- 依赖 Directus 中已有的社区、楼栋、房屋数据
- 需要初始化物业费单价、缴费规则等配置数据

### 6.3 外部依赖
- 微信小程序平台（文件上传、图片预览等 API）
- Directus REST API 和文件管理 API
- （可选）短信服务（用于催缴通知）

### 6.4 业务约束
- 财务数据必须真实准确，录入后不可随意删除
- 员工工资等敏感信息需要脱敏处理
- 账单生成规则需要物业提前配置（单价、面积等）

> **v2.0+ 扩展约束**：维修基金的使用必须经过业委会审批

---

## 7. 风险与应对

### 7.1 技术风险

| 风险 | 影响 | 概率 | 应对措施 |
|------|------|------|----------|
| 大量数据导致性能问题 | 高 | 中 | 实现分页、缓存、虚拟滚动 |
| Directus 权限配置复杂 | 中 | 高 | 详细设计权限方案，充分测试 |
| 文件上传失败 | 中 | 低 | 实现上传重试机制，提供错误提示 |
| 数据计算错误（金额） | 高 | 低 | 充分的单元测试，前后端双重校验 |

### 7.2 业务风险

| 风险 | 影响 | 概率 | 应对措施 |
|------|------|------|----------|
| 业主不信任线上数据 | 高 | 中 | 提供数据溯源，保留所有凭证 |
| 物业录入数据错误 | 高 | 高 | 实现审核机制，重要操作二次确认 |
| 隐私泄露 | 高 | 低 | 严格权限控制，敏感数据脱敏 |
| 历史数据迁移困难 | 中 | 中 | 提供数据导入工具，支持批量导入 |

### 7.3 时间风险

| 风险 | 影响 | 概率 | 应对措施 |
|------|------|------|----------|
| 开发时间超出预期 | 中 | 中 | 分阶段交付，优先实现核心功能（P0） |
| 测试时间不足 | 高 | 中 | 增加自动化测试，提前进行灰度测试 |
| 需求变更频繁 | 中 | 高 | 需求冻结机制，变更需评估影响 |

---

## 8. 发布计划

### 8.1 里程碑（MVP 阶段）

| 里程碑 | 交付内容 | 预计时间 | 状态 |
|--------|----------|----------|------|
| **M1: 需求确认** | PRD、设计文档、开发文档（MVP 范围） | Week 1 | 🚧 进行中 |
| **M2: 数据层完成** | 核心表创建、权限配置、Directus 后台配置 | Week 1 | ⏳ 未开始 |
| **M3: 后台系统验证** | 使用 Directus 后台录入测试数据 | Week 1 | ⏳ 未开始 |
| **M4: Store 层完成** | Pinia Store 实现（业主端查询）、API 调用 | Week 2 | ⏳ 未开始 |
| **M5: 业主端完成** | 5 个业主小程序页面实现（F1-F4, F6） | Week 4 | ⏳ 未开始 |
| **M6: 测试与优化** | 功能测试、性能测试、修复 Bug | Week 5 | ⏳ 未开始 |
| **M7: 上线发布** | 灰度发布、全量发布 | Week 6 | ⏳ 未开始 |

> **注**：由于物业端使用 Directus 后台，无需开发专门界面，MVP 周期从 9 周缩短至 **6 周**。
>
> **v2.0+ 里程碑规划**：
> - **M8**: 物业端专用管理界面开发（可选，提升易用性）
> - **M9**: 维修基金功能开发（4表 + 业主端1页 + 后台界面）
> - **M10**: 业委会功能开发（2页 + 审批流程）
> - **M11**: 高级功能（报表导出、数据分析、催缴通知）

### 8.2 分阶段交付策略

**Phase 1（MVP v1.0）- 核心财务透明功能** ⭐：

**业主端 - 小程序（5个页面）**：
- F1. 财务概览（不含维修基金）
- F2. 我的账单
- F3. 账单详情
- F4. 月度账目
- F6. 公共收入明细

**物业端 - 后台系统（Directus 或简单网页）**：
- F7. 账单管理（通过 Directus `billings` collection）
- F8. 缴费录入（通过 Directus `billing_payments` collection）
- F9. 收入录入（通过 Directus `incomes` collection）
- F10. 支出录入（通过 Directus `expenses` collection，不含维修基金支出类型）
- F11. 员工管理（通过 Directus `employees` collection）
- F12. 工资录入（通过 Directus `salary_records` collection）
- F13. 逾期账单查询（通过 Directus filters + 自定义视图）

> **实现方式**：
> - 优先使用 Directus Admin Panel 的原生功能
> - 如需自定义界面，开发简单 HTML 页面调用 Directus API
> - 关键业务逻辑（如账单状态自动更新）通过 Directus Flows 或 Hooks 实现

**Phase 2（v1.5）- 物业端专用管理界面**（可选）：
- 开发物业管理员专用的 Web 管理界面（替代 Directus 后台）
- 优化数据录入流程和用户体验
- 增加批量导入、数据导出功能
- 提供更友好的逾期账单查询和催缴功能

**Phase 3（v2.0）- 在线支付功能** ⭐：
- 业主端：账单列表和详情页增加"立即缴费"按钮
- 集成微信支付 API
- 支付成功后自动更新账单状态和缴费记录
- 支付失败处理和重试机制
- 支付记录查询和凭证下载

> **注**：在线支付功能是 v2.0 的核心升级，将大幅提升业主缴费便利性

**Phase 4（v2.5）- 维修基金管理**：
- 维修基金数据表（4张）
- 业主端：查看维修基金账户（F5）
- 后台系统：录入维修基金缴存和使用
- 支出类型扩展：维修基金支出

**Phase 5（v2.8）- 业委会监督功能**：
- 业委会角色权限配置
- 业委会端小程序页面（2页）
- 维修基金审批流程（F14）
- 业委会财务总览（F15）
- 大额支出审批流程

**Phase 6（v3.0）- 高级功能**：
- 财务报表导出（PDF/Excel）
- 数据可视化分析（图表、趋势）
- 催缴通知自动化（短信/小程序消息）
- 支付宝等更多支付方式
- 移动端物业管理（物业小程序端，方便移动办公）

---

## 9. 附录

### 9.1 术语表

| 术语 | 英文 | 定义 |
|------|------|------|
| **业主** | Resident | 小区房屋的产权所有者或租户 |
| **物业管理员** | Property Manager | 负责小区日常管理和财务记录的工作人员 |
| **业委会** | Committee | 业主委员会成员，负责监督物业和重大决策 |
| **应收账单** | Billing | 物业根据面积和单价生成的应缴费用 |
| **实收记录** | Billing Payment | 业主实际缴纳的金额记录 |
| **公共收入** | Public Income | 小区公共设施/资源产生的收入 |
| **维修基金** | Maintenance Fund | 用于房屋公共部位维修的专项资金 |
| **账期** | Period | 账单所属的月份（格式：YYYY-MM） |

### 9.2 参考文档
- 《物业管理条例》
- 《住宅专项维修资金管理办法》
- 微信小程序开发文档
- Directus 官方文档

### 9.3 变更记录

| 版本 | 日期 | 修改人 | 修改内容 |
|------|------|--------|----------|
| v1.0 | 2025-01-XX | 初稿 | 初始版本，基于已有讨论和实现 |
| v2.0 | 2025-10-13 | Claude | 重新整理为标准 PRD 格式 |
| v2.1 | 2025-10-13 | Claude | 明确 MVP 范围：维修基金和业委会功能标记为 v2.0+ |
| v2.2 | 2025-10-13 | Claude | 架构调整：物业端功能使用 Directus 后台，MVP 只开发业主端小程序 |
| v2.3 | 2025-10-13 | Claude | **业主缴费调整**：MVP 只做展示，不包含线上支付功能；在线支付推迟到 v2.0 版本实现 |

---

**审批流程**：

| 角色 | 姓名 | 审批意见 | 日期 |
|------|------|----------|------|
| 产品负责人 | 待定 | 待审批 | - |
| 技术负责人 | 待定 | 待审批 | - |
| 业务负责人 | 待定 | 待审批 | - |

---

**文档状态**：🚧 待审批

**下一步行动**：请相关负责人审阅本文档，提出修改意见，完成审批后进入设计阶段。
